<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">

<title>New HMTL document by NewJect</title>
    <style>
        .axis path,
        .axis line{
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
        }

        .axis text {
            font-family: sans-serif;
            font-size: 11px;
        }
    </style>
<script src="d3.js"></script>
</head>
<body>
<div id="datetime"></div>
<div>


<h3>this is new html document generated by newject extention</h3>
    <h3></h3>
    <h3></h3>
</div>

    <script>
        var vflag = 1;
        d3.select('#datetime')
            .text(function() {return new Date;})
            .append('p')
                .text('version: ' + vflag);

        //////////////////////////////////////////////////////////////////

        var data = ['a', 'b', 'c', 'd', 'e', 'f'];
        var h = d3.select('body').selectAll('h3').data(data);
        h.text(function(d, i) {
            return d + '' + i;
        });

        h.enter().append('h3').text(function(d, i) {
            return d + '' + i;
        });

        /////////////////////////////////////////////////////////////////
        data = [20, 35, 32, 12, 22];

        var linear = d3.scale.linear()
                    .domain([0, d3.max(data)])
                    .range([0, 490]);

        var axis = d3.svg.axis()
                    .scale(linear)
                    .orient('bottom')
                    .ticks(10);

        var rh = 30;
        var svg = d3.select('body')
                .insert('svg', '#datetime')
                .attr('width', 500)
                .attr('height', 300)
                .append('g')
                    .attr('transform', 'translate(5, 0)');

        svg.selectAll('rect')
            .data(data)
            .enter()
                .append('rect')
                .attr('x', 0)
                .attr('y', function(d, i) { return i * rh})
                .attr('height', rh - 2)
                .attr('width', 0)
                .attr('fill', 'steelblue')
                .on('mouseover', function () {
                    d3.select(this).attr('fill', 'red');
                })
                .on('mouseout', function () {
                    d3.select(this)
                        .transition()
                        .duration(500)
                        .attr('fill', 'steelblue');
                })
                .transition()
                    .duration(2000)
                    .delay(function(d, i) {return i * 200})
                    .ease('bounce')
                    .attr('width', function (d, i) { return linear(d)})

        // 生成坐标轴
        svg.append('g')
            .attr('class', 'axis')
            .attr('transform', 'translate(0, ' + (data.length * rh + 5) + ')')
            .call(axis);


        ////////////////////////////////////////////////////////////////////////////////
        // 布局
        var canvas = d3.select('body')
                    .append('svg')
                    .attr({width: 500, height: 400})
                    .append('g');

        var pie = d3.layout.pie();
        var piedata = pie(data);
        var outerRadius = 150;
        var innerRadius = 50;
        var color = d3.scale.category10();

        var arc = d3.svg.arc() // 弧度生成器
                    .innerRadius(innerRadius)  // 内半径
                    .outerRadius(outerRadius); // 外半径

        var arcs = canvas.selectAll('g')
            .data(piedata)
            .enter()
                .append('g')
                .attr('transform', 'translate(250, 200)');

        arcs.append('path')
            .attr('fill', function (d, i) { return color(i); })
            .attr('d', arc);

        arcs.append('text')
            .attr('transform', function (d) {
                return 'translate(' + arc.centroid(d) + ')';
            })
            .attr('text-anchor', 'middle')
            .text(function (d) { return d.data; });






        ///////////////////////////////////////////////////////////////////////////////////////////////
        d3.select('body').append('h5').text('~~end/////////////////////////////');
    </script>
</body>
</html>
